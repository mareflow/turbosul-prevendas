<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Pr√©-Vendas TurboSul</title>
    
    <!-- Inclus√£o do Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Importa√ß√£o da fonte 'Inter' do Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Estilos customizados e anima√ß√µes -->
    <style>
        /* Define a fonte 'Inter' como padr√£o para toda a p√°gina */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Anima√ß√£o de entrada para o card, replicando o login */
        @keyframes fadeInScaleUp {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-entry {
            animation: fadeInScaleUp 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen px-4">

    <!-- Card Principal com o Conte√∫do do Dashboard de Pr√©-Vendas -->
    <main class="w-full max-w-md bg-white rounded-xl shadow-lg p-10 text-center animate-entry">
        <!-- Logo e T√≠tulo -->
        <div class="flex flex-col items-center mb-6">
            <img src="https://i.postimg.cc/Jh5Jvrc9/IMG-7901.png" alt="Logo TurboSul" class="w-24 h-24 mb-4">
            <h1 class="text-2xl font-bold text-gray-800">Dashboard Pr√©-Vendas</h1>
        </div>

        <!-- Mensagem de Sucesso -->
        <div class="mb-8">
            <p class="text-lg text-green-600 font-semibold mb-2">üéâ Autentica√ß√£o bem-sucedida!</p>
            <p class="text-gray-600">Sua √°rea de trabalho est√° pronta para o controle de produ√ß√£o.</p>
        </div>

        <!-- Bot√£o de Sair (Logout) -->
        <button 
            id="logout-button"
            class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg focus:outline-none focus:ring-4 focus:ring-red-600 focus:ring-opacity-50 transition-all duration-300 ease-in-out"
        >
            Sair
        </button>
    </main>

    <!-- Inclus√£o da biblioteca do Supabase via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- L√≥gica de Verifica√ß√£o de Sess√£o e Logout com JavaScript Puro -->
    <script>
        // 1. Inicializa√ß√£o do Cliente Supabase
        const SUPABASE_URL = 'https://zghaqlaqozsskfldgsfe.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpnaGFxbGFxb3pzc2tmbGRnc2ZlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkyMDY1MzQsImV4cCI6MjA4NDc4MjUzNH0.aC2DMOUNhS2uK6KGI5Sf2c2vGhrCKHMnRyZhL3WwSus';
        
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // 2. Verifica√ß√£o de Sess√£o (Prote√ß√£o de Rota)
        async function checkSessionAndProtectRoute() {
            // Tenta obter a sess√£o do usu√°rio
            const { data: { session }, error } = await supabase.auth.getSession();

            // Se n√£o houver sess√£o ou houver erro, redireciona para o login
            if (error || !session) {
                // Redireciona para o login (assumindo que o index.html √© a p√°gina de login)
                window.location.href = '/index.html'; 
            }
            // Se houver sess√£o, o usu√°rio permanece na p√°gina.
        }

        // Executa a verifica√ß√£o assim que a p√°gina carregar
        checkSessionAndProtectRoute();


        // 3. L√≥gica do Bot√£o de Sair (Logout)
        const logoutButton = document.getElementById('logout-button');

        logoutButton.addEventListener('click', async () => {
            // Chama a fun√ß√£o de desautentica√ß√£o do Supabase
            const { error } = await supabase.auth.signOut();

            if (error) {
                console.error("Erro ao fazer logout:", error);
                alert("Erro ao sair da sess√£o. Tente novamente.");
            } else {
                // Redireciona o usu√°rio de volta para a p√°gina de login
                window.location.href = '/index.html';
            }
        });
    </script>
</body>
</html>
